Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2014-06-20T10:47:18+08:00

====== Keyguard ======
Created Friday 20 June 2014


{{./pasted_image.bmp}}

==== 1先贴上layout布局文件 ====
[[+keyguard_host_view.xml|keyguard_host_view.xml]]

==== 一切都为绕它转 ====



==== 1.KeyguardHostview ====
一看就知道是个中心。几乎包括了所有东西：widget， background， 
	1.继承了KeyguardViewBase 定义了keyguard基本的接口，如onScreenTurnedOff，verifyUnlock, immediateCleanUp,同时还截获音量键处理
	2.
 228         DevicePolicyManager dpm =
 229                 (DevicePolicyManager) mContext.getSystemService(Context.DEVICE_POLICY_SERVICE);	
	3.
 240             final String packageName = "system";                                                                                                                                                        
 241             userContext = mContext.createPackageContextAsUser(packageName, 0,
 242                     new UserHandle(mUserId));
	4.
1426    public static boolean isSafeModeEnabled() {
1427        try {
1428            return IWindowManager.Stub.asInterface(
1429                    ServiceManager.getService("window")).isSafeModeEnabled();
	5.reportFailedUnlockAttempt()
	6.void showPrimarySecurityScreen(boolean turningOff)
	7.showBackupSecurityScreen()
	8.      __hostView.mViewStateManager.showBouncer?__
	9.
	1350         // Don't show camera or search in navbar when SIM or Account screen is showing
	1351         setSystemUiVisibility(isSimOrAccount ?
	1352                 (getSystemUiVisibility() | View.STATUS_BAR_DISABLE_SEARCH)
	1353                 : (getSystemUiVisibility() & ~View.STATUS_BAR_DISABLE_SEARCH))
	10.K__eyguardWidgetPager__
	11.__mInsets?__
	

=== 2.KeyguardViewManager ===
Manages creating, showing, hiding and resetting the keyguard    包装了一些KeyguardViewHost的方法
----------->ViewManagerHost   好像只是设置了一下背景

=== 3.KeyguardViewMediator ===
 81  * Mediates requests related to the keyguard.  This includes queries about the
  82  * state of the keyguard, power management events that effect whether the keyguard
  83  * should be shown or reset, callbacks to the phone window manager to notify
  84  * it of when the keyguard is showing, and events from the keyguard view itself
  85  * stating that the keyguard was succesfully unlocked.
	1.AlarmManager    AudioManager    StatusBarManager    PowerManager  UserManager    SearchManager  KeyguardViewManager  KeyguardDisplayManager 的确是一个中介
	

=== 4.KeyguardUpdaterMonitor ===
Watches for updates that may be interesting to the keyguard, and provides the up to date information as well as a registration for callbacks that care
 to be updated.

